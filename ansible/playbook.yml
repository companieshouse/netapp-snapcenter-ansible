---
- name: Provision Ansible controller with SSH key for remote
  hosts: localhost
  roles:
    - role: companieshouse.general.ssh_key
      vars:
        ssh_key_name: ansible_remote
        ssh_key_vault_path: "{{ vault_base_path }}/ssh/ansible_private_key"

- name: NetApp SnapCenter install and setup
  hosts: aws_ec2
  remote_user: ansible-user
  become: true
  gather_facts: true
  roles:
    - role: instance_facts
    - role: vault_facts
    - role: hostname
    - role: mount_snapcenter_data
    - role: prerequisites
    - role: mysql_setup
    - role: selinux_config
    - role: snapcenter_download
    - role: snapcenter_install
    - role: snapcenter_post_install
    - role: snapcenter_add_users
    - role: root_user_secure
    - role: companieshouse.security.security_scans
